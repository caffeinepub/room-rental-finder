{
  "kind": "build_request",
  "title": "Add room photo upload functionality",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-11",
      "text": "Update the RoomListing type in backend/main.mo to include a photos field that stores an array of image URLs or base64-encoded image data strings",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-photo-upload"
        ],
        "quotes": [
          "Mai isme room ke photos bhi upload karna chahta hoon"
        ]
      },
      "acceptanceCriteria": [
        "RoomListing type includes a photos field of type [Text] or similar array structure",
        "Existing addRoomListing function accepts photos parameter",
        "Photos are persisted in the backend storage Map"
      ]
    },
    {
      "id": "REQ-12",
      "text": "Add image upload functionality to the AddListingPage form that allows users to select and upload multiple room photos (at least 3-5 photos per listing)",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-photo-upload"
        ],
        "quotes": [
          "Mai isme room ke photos bhi upload karna chahta hoon"
        ]
      },
      "acceptanceCriteria": [
        "File input field accepts multiple image files (JPEG, PNG)",
        "Preview thumbnails display selected images before submission",
        "Images are converted to base64 or uploaded format compatible with backend",
        "Form validation ensures at least one photo is uploaded",
        "Upload progress or loading state is shown during submission"
      ]
    },
    {
      "id": "REQ-13",
      "text": "Update RoomCard component to display the first uploaded room photo instead of the placeholder image, with fallback to placeholder if no photos exist",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-photo-upload"
        ],
        "quotes": [
          "Mai isme room ke photos bhi upload karna chahta hoon"
        ]
      },
      "acceptanceCriteria": [
        "RoomCard renders the first photo from the photos array when available",
        "Placeholder image displays when photos array is empty or undefined",
        "Images maintain proper aspect ratio and card layout"
      ]
    },
    {
      "id": "REQ-14",
      "text": "Update RoomDetailPage to display all uploaded room photos in a gallery or carousel format with navigation between images",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-photo-upload"
        ],
        "quotes": [
          "Mai isme room ke photos bhi upload karna chahta hoon"
        ]
      },
      "acceptanceCriteria": [
        "All uploaded photos are displayed in an interactive gallery or carousel",
        "Users can navigate between photos using next/previous controls or thumbnails",
        "Main image displays at appropriate size with proper aspect ratio",
        "Gallery handles single photo, multiple photos, and no photos scenarios gracefully"
      ]
    },
    {
      "id": "REQ-15",
      "text": "Update the useQueries.ts hooks to handle the new photos field when fetching and submitting room listings",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-photo-upload"
        ],
        "quotes": [
          "Mai isme room ke photos bhi upload karna chahta hoon"
        ]
      },
      "acceptanceCriteria": [
        "useAddRoomListing mutation includes photos parameter in the backend call",
        "Query hooks properly type and return photos field from backend responses",
        "TypeScript types are updated to include photos field"
      ]
    }
  ],
  "constraints": [
    "Maintain single-actor architecture in backend/main.mo",
    "Do not modify immutable frontend paths (useInternetIdentity.ts, useActor.ts, main.tsx, components/ui)",
    "Preserve existing warm, welcoming visual theme with earthy tones",
    "Ensure PWA functionality remains intact"
  ],
  "nonGoals": [
    "External image hosting services or CDN integration",
    "Image compression or optimization beyond basic browser handling",
    "Advanced photo editing features",
    "Video upload functionality"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}